# 1. Web Gauntlet

## Description
> Can you beat the filters?
Log in as admin http://shape-facility.picoctf.net:63961/ http://shape-facility.picoctf.net:63961/filter.php

## Solution
First I tried inputting username as admin and password as admin and got this:
<img width="1919" height="588" alt="image" src="https://github.com/user-attachments/assets/8dff2341-6031-4ce4-999e-6b0650f7b807" />


The text on top left corner told me that it was something related to SQL and I was to figure out methods of bypassing that command.
So I tried using single line comments to comment out the second part of the command like this:
<img width="1859" height="547" alt="image" src="https://github.com/user-attachments/assets/9efd800b-6a57-4c5c-a760-336902d8e82b" />


On passing the first round, I got an idea of what was expected for the coming rounds. I checked the filters and it showed that -- was blocked. So I used multi-line comments /* */
<img width="1919" height="538" alt="image" src="https://github.com/user-attachments/assets/e1969a23-487e-4c13-a81d-549b40cba349" />


In the next round, both single and multi-line commands were blocked, so I terminated the command at the first half using ;
<img width="1918" height="563" alt="image" src="https://github.com/user-attachments/assets/2c2d8b64-5595-4e6d-98d8-2ab411b734a5" />


In this round, the word admin was also blocked. So I used SQLite concatenation operator '||' to solve this round and the next round: 
<img width="1919" height="570" alt="image" src="https://github.com/user-attachments/assets/b749f905-1257-407e-b42d-f3d069ea1009" />
<img width="1860" height="592" alt="image" src="https://github.com/user-attachments/assets/16d82753-bb41-4f21-b825-32215f8f368a" />

## Flag:
```picoCTF{y0u_m4d3_1t_79a0ddc6}```

## Concepts Learnt:
I learnt how to do SQLite injections and bypass commands using commenting, and concatenation.

## References
<https://www.geeksforgeeks.org/sql/sql-concatenation-operator/>

***

# 2. SSTI1

## Description
> I made a cool website where you can announce whatever you want! Try it out! I heard templating is a cool and modular way to build web apps! Check out my website here!

## Solution
On launching the instance, I was able to access a website that said it would announce whatever input I provide. 
The description talks about templating and the challenge's name is SSTI (which stands for Server Side Template Injection) so I found some resources that explained that Jinja2 was a common templating engine and was able to find a command to execute a shell command 'id', which is a Linux command used to return user info. 
```Jinja2
{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}
```
With this knowledge, I tried using ls command to look for any further clues and found that there was a file call flag.
```Jinja2
{{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}}
```
<img width="1864" height="241" alt="image" src="https://github.com/user-attachments/assets/aa253dbf-3ff0-4d02-9a49-b2a588441b57" />
On using cat command, I was able to read the flag file and obtained the correct flag.
```Jinja2
{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}
```
<img width="1301" height="119" alt="image" src="https://github.com/user-attachments/assets/0835964b-fa40-4121-97cd-bb13b47140aa" />

## Flag:
```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_bdc95c1a}
```
## Concepts Learnt:
I learnt about templating engines such as jinja2 used for python based web apps, twig etc. and got an idea of how SSTI exploitations are carried out (RCE bypassing in this case)

## Notes:
I tried announcing various inputs and checked the Inspect tool but to no avail.

## Resources:
<https://medium.com/@bootstrapsecurity/server-side-template-injection-ssti-advanced-exploitation-techniques-2d8ccdf6270f>
<https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Template%20Injection/Python/#jinja2-remote-command-execution>
<https://onsecurity.io/article/server-side-template-injection-with-jinja2/>

***

# 3. Cookies

## Description
> Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:17781/

## Solution
First I inputted "snickerdoodle" to see the output. 
<img width="958" height="514" alt="image" src="https://github.com/user-attachments/assets/470d7683-a46b-4104-9df3-cb1b2aba8aca" />

Then, I checked the Cookies tab under Application and saw that the value of the cookie was 0 and when I went back to Home, it changed to -1.
I tried searching up a list of cookie names like chocolate chip, oatmeal raisin etc. On inputting these and checking the value, it went from 1 to 2 
<img width="1846" height="631" alt="image" src="https://github.com/user-attachments/assets/0de0d390-723a-4dbd-836a-dc03efdc585a" />

This gave me a hint that the value was somehow related to the flag and by incrementing it by 2,3,4 etc upto 18, I was finally able to obtain the flag. 
<img width="1843" height="534" alt="image" src="https://github.com/user-attachments/assets/ad04cf8d-b8f9-402c-b1cd-035bd17aedd3" />

## Flag:
```picoCTF{3v3ry1_l0v3s_c00k135_bb3b3535}```

## Concepts Learnt:
I learnt how cookies and it's values are correlated.

***
